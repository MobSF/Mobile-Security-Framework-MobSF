from pprint import pprint
from pycti import OpenCTIApiClient

#please change url and token if u are to run OpenCTI differntly then I have ;)
api_url = 'http://192.168.122.1:8080'
api_token = 'e0814fb2-8abc-4afb-a9bd-204aeff4dd1e'
search_url = 'http://192.168.122.1:8080/dashboard/search/'

opencti_api_client = OpenCTIApiClient(api_url, api_token)
apk_url = "https://youtubepremiumapp.com/" # please change this to retrieve from analysis if u decide to implement it

def Checking_URL(apk_url):
    # Try using a pattern that matches the exact URL
    pattern = f"[url:value = '{apk_url}']"

    # Execute the query
    indicators = opencti_api_client.indicator.list(search=pattern)
    for indicator in indicators:
        if indicator['name'] == apk_url:
            print("related information found in OpenCTI please check here " + search_url)
            print('Information name ' + indicator['name'])
            pprint(indicator)
            break
        else:
            print("No related information found in OpenCTI")


def main():
    Checking_URL(apk_url)


if __name__ == "__main__":
    main()

